/**
 * @author Takahiro INOUE <takahiro.inoue@aist.go.jp>
 * @license Songle Widget API Examples
 *
 * Visit http://songle.jp/info/Credit.html OR http://widget.songle.jp/docs/v1 for documentation.
 * Copyright (c) 2015 National Institute of Advanced Industrial Science and Technology (AIST)
 *
 * Distributed under the terms of the MIT license only for non-commercial purposes.
 * http://www.opensource.org/licenses/mit-license.html
 *
 * This notice shall be included in all copies or substantial portions of this Songle Widget API Examples.
 * If you are interested in commercial use of Songle Widget API, please contact "songle-ml@aist.go.jp".
 */
(function(){if(window.__swExtra__==null){window.__swExtra__={}}__swExtra__.initializeAllModule=function(a){if(__swExtra__.modules==null){__swExtra__.modules=[]}__swExtra__.modules.push(a);window.onSongleWidgetCreate=function(c,b){return __swExtra__.initializeCreateModule(b)};window.onSongleWidgetError=function(c,b){return __swExtra__.initializeErrorModule(b)};return window.onSongleWidgetReady=function(c,b){return __swExtra__.initializeReadyModule(b)}};__swExtra__.initializeCreateModule=function(c,d){var e,g,b,f,a;if(d==null){d={}}if(d.force==null){d.force=false}f=__swExtra__.modules;a=[];for(g=0,b=f.length;g<b;g++){e=f[g];if(!e.__wasCreated__||d.force){e.onCreate&&e.onCreate(c)}a.push(e.__wasCreated__=true)}return a};__swExtra__.initializeErrorModule=function(c,d){var e,g,b,f,a;if(d==null){d={}}if(d.force==null){d.force=false}f=__swExtra__.modules;a=[];for(g=0,b=f.length;g<b;g++){e=f[g];if(!e.__wasErrored__||d.force){e.onError&&e.onError(c)}a.push(e.__wasErrored__=true)}return a};__swExtra__.initializeReadyModule=function(c,d){var e,g,b,f,a;if(d==null){d={}}if(d.force==null){d.force=false}f=__swExtra__.modules;a=[];for(g=0,b=f.length;g<b;g++){e=f[g];if(!e.__wasReadied__||d.force){e.onReady&&e.onReady(c)}a.push(e.__wasReadied__=true)}return a};__swExtra__.random=function(b,a){if(b==null){b=0}if(a==null){a=2147483647}return Math.floor(Math.random()*((a-b)+1)+b)}}).call(this);(function(){var a;__swExtra__.initializeAllModule({onReady:function(c){var e,d,b;if(!window.createjs){d=0;e=document.createElement("script");e.async=false;e.defer=false;e.src="https://code.createjs.com/easeljs-0.8.1.min.js";e.type="text/javascript";e.addEventListener("load",function(){++d;if(d>=2){return a(c)}},false);document.body.appendChild(e);b=document.createElement("script");b.async=false;b.defer=false;b.src="https://code.createjs.com/tweenjs-0.6.1.min.js";b.type="text/javascript";b.addEventListener("load",function(){++d;if(d>=2){return a(c)}},false);return document.body.appendChild(b)}else{return a(c)}}});a=function(k){var c,f,q,r,j,e,p,i,n,l,m,d,g,o,b,h;setTimeout(function(){var s,t;t=document.querySelector(".sw-extra-visualizer");if(!t){t=document.createElement("canvas");t.className="sw-extra-visualizer";t.width=i();t.height=p();t.style.position="fixed";t.style.left=0+"px";t.style.top=0+"px";t.style.zIndex=-1;document.body.appendChild(t)}addEventListener("scroll",function(){t.width=i();return t.height=p()},false);addEventListener("resize",function(){t.width=i();return t.height=p()},false);s=new createjs.Stage(t);createjs.Ticker.addEventListener("tick",function(u){return s.update(u)});createjs.Ticker.setFPS(60);k.on("beatPlay",function(u){if(u.beat.position===1){switch(__swExtra__.random(f,c)){case 1:return o(s);case 2:return g(s);case 3:return n(s);case 4:return l(s);case 5:return m(s)}}});k.on("chordPlay",function(z){var w,x,B,u,A,v,y;A=z.chord.prev;x=z.chord;if(A){w=A.name.match(/^([A-G#]{1,2})/)||[];y=w[1]||"N"}else{y="N"}v=q[y];if(x){w=x.name.match(/^([A-G#]{1,2})/)||[];u=w[1]||"N"}else{u="N"}B=q[u];return createjs.Tween.get(v).to(B,250).addEventListener("change",function(D){var C;C=D.target.target;C.r=Math.floor(C.r);C.g=Math.floor(C.g);C.b=Math.floor(C.b);return t.style.backgroundColor="rgb("+C.r+","+C.g+","+C.b+")"})});k.on("chorusSegmentEnter",function(u){return b(s,{color:r,direction:"L"})});k.on("repeatSegmentEnter",function(u){return b(s,{color:j,direction:"R"})});k.on("play",function(){return h(s)});k.on("seek",function(){return h(s)});return k.on("finish",function(){return h(s)})},0);f=1;c=5;e="#e17";q={A:{r:204,g:204,b:238},"A#":{r:204,g:204,b:255},B:{r:204,g:238,b:204},C:{r:204,g:238,b:238},"C#":{r:204,g:255,b:255},D:{r:238,g:204,b:204},"D#":{r:255,g:204,b:204},E:{r:238,g:204,b:238},F:{r:238,g:238,b:204},"F#":{r:255,g:255,b:204},G:{r:238,g:238,b:238},"G#":{r:255,g:255,b:255},N:{r:255,g:255,b:255}};r="#f84";j="#48f";i=function(){return window.innerWidth};p=function(){return window.innerHeight};d=function(t,s){var u;if(s==null){s={}}if(s.r==null){s.r=0}if(s.vertexCount==null){s.vertexCount=0}u=new createjs.Shape;u.graphics.beginStroke(e).drawPolyStar(0,0,20,s.vertexCount,s.r,__swExtra__.random(0,360));u.x=__swExtra__.random(0,i());u.y=__swExtra__.random(0,p());createjs.Tween.get(u).to({alpha:0,scaleX:20,scaleY:20},2000);return t.addChild(u)};o=function(s){return d(s,{vertexCount:3})};g=function(s){return d(s,{vertexCount:4})};n=function(s){return d(s,{r:0.2,vertexCount:5})};l=function(s){return d(s,{r:0.2,vertexCount:7})};m=function(s){return d(s,{vertexCount:100})};b=function(v,u){var t,w,s;if(u==null){u={}}if(u.color==null){u.color=e}if(u.direction==null){u.direction="L"}s=[];for(t=w=0;w<10;t=++w){s.push((function(x){var y;y=new createjs.Shape;y.graphics.beginStroke(u.color).drawCircle(0,0,20);switch(u.direction){case"L":y.x=i()/10*x;y.y=p()/2;break;case"R":y.x=i()/10*(10-x);y.y=p()/2}return setTimeout(function(){createjs.Tween.get(y).to({alpha:0,scaleX:20,scaleY:20},2000);return v.addChild(y)},200*x)})(t))}return s};return h=function(s){return s.removeAllChildren()}}}).call(this);